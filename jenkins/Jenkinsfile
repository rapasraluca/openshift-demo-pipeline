library identifier: "pipeline-library@master", retriever: modernSCM(
  [$class: "GitSCMSource",
   remote: "https://github.com/redhat-cop/pipeline-library.git"])

pipeline{
    agent{
        label "nodejs"
    }
    stages{
        stage("Checkout code"){
            steps{
                git branch: "testRalu",
                    url: 'https://github.com/rapasraluca/openshift-demo-pipeline.git'
            }
        }
        stage("Build code"){
            steps{
                sh '''
                cd gremlins
                cat ./src/App.js
                npm install
                npm run-script build
                '''
            }
        }
        stage("Binary build"){
            steps{
                binaryBuild([
                        buildConfigName: "gremlins-build",
                        buildFromFlag  : "--from-dir",
                        buildFromPath  : "${WORKSPACE}/gremlins/build/"
                ])
            }
        }
    }
}